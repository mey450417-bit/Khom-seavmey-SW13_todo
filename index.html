<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">

</head>
<style>
   .box {
        width: 500px;
        height: 500px;
        border-radius: 10px  ;
        box-shadow: 1px 11px 22px #f58dd9;
        margin-top: 10px;
        padding: 10px;
        background-image: url(pic/yyy.jpg) ;
        background-size: cover;
        background-position: center; 

    }

    #todo_list {
        list-style: none;
       
    }

    #todo_list li {
        margin: 20px;
       
    }
    .add{
       background-color: pink;
       border: #CCC;
    }
   
</style>

<body>
    <center>
        <div class="box" id="box">
            <label for="">Todo: </label>
            <input id="todo_input" placeholder="Enter your todo" type="text">
            <input type="button" class="add" value="Add" id="btn_add">
            <input style="display: none;" type="button" value="Edit" id="btn_edit">
            <hr >
            <ul id="todo_list"></ul>
            <br>
        </div>
    </center>

</body>
<script>
    let todo_arr = []
    let todo_list = document.getElementById("todo_list")
    let btn_add = document.getElementById("btn_add")
    let todo_input = document.getElementById("todo_input")
    let status='add'
    let globel_index=-1

    renderTodolist()
    function renderTodolist() {
        let task_string = ""
        for (let item of todo_arr) {
            let btn_Done=` <input type="button" value="✅" onclick="makeisDone(${item.id})">`
           let task_name=`<strong>${item.id}.</strong><span>${item.task}</span>`
           if(item.isDone){
              task_name=`<del>${item.id}</del><del>${item.task}</del>`
              btn_Done=""
           }
            task_string +=`
            <li>
                   
                    ${task_name}
                    ${btn_Done}
                    <input type="button" value="✏️" onclick="edit(${item.id})">
                    <input type="button" value="❎" onclick="deleteTask(${item.id})">
            </li>` 
                            
                               
            }
            todo_list.innerHTML = task_string
          
        }

    btn_add.addEventListener('click', function () {
        let todo_text = todo_input.value.trim()
        if(!todo_input.value){
            alert("please Input Task")
        }else{
                const exists = todo_arr.some(item => item.task.toLowerCase() === todo_text.toLowerCase())
        if (exists) {
            alert("This task already Duplicate!")
            return
        }else{
                   if(status==='add'){
         todo_arr.push({
            id: todo_arr.length + 1,
            task: todo_text,
            isDone: false
        })
       }
       else{
        todo_arr[globel_index].task=todo_text;
       }
        renderTodolist()
        clearForm()

        }
  
        }
    })
    todo_input.addEventListener('keypress', function(e){
        if (e.key == 'Enter') {
            btn_add.click()
        }
    })

    function deleteTask(id){
    let index=-1
        for(let i=0;i<todo_arr.length;i++){
            if(todo_arr[i].id===id){
               
                index=i
               
            }clearForm()
        if(confirm){
              Swal.fire({
  title: "Are you sure?",
  text: "You won't be able to revert this!",
  icon: "warning",
  showCancelButton: true,
  confirmButtonColor: "#3085d6",
  cancelButtonColor: "#d33",
  confirmButtonText: "Yes, delete it!"
}).then((result) => {
  if (result.isConfirmed) {
     todo_arr.splice(index,1)
            renderTodolist()
  }
});
        }

        }  
    }
     function edit(id){
      let index=-1
        for(let i=0;i<todo_arr.length;i++){
            if(todo_arr[i].id==id){
               
                index=i
            }
        }
        todo_input.value=todo_arr[index].task
        status='edit'
        btn_add.value='Edit'
        btn_add.style.backgroundColor='blue'
        globel_index=index
    }
     function makeisDone(id){
      let index=-1
        for(let i=0;i<todo_arr.length;i++){
            if(todo_arr[i].id==id){
               
                index=i
            }
        }
        todo_input.value=todo_arr[index].isDone =true
        clearForm()
        renderTodolist()
     }
         function clearForm(){
        todo_input.value= ""
        todo_input.focus()
        status='add'
        btn_add.style.backgroundColor='pink'
        btn_add.value='Add'
        globel_index=-1
    }



</script>

</html>
